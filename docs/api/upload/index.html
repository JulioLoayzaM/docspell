<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="author" content="Eike Kettner">
<meta name="description" content="Docspell is a Document Management System (DMS), a system that asists in organizing your piles of documents, resulting from scanners, e-mails and other sources with miminal effort.">
<meta name="keywords" content="document management system dms organizer ocr open source free scan pdf word doc archive gpl machine learning nlp auto tagging"/>
<meta name="robots" content="index,follow"/>
<meta name="image" property="og:image" content="/img/poster.png">
<meta name="title" property="og:title" content="Docspell – Simple Document Organizer">
<meta name="og:image" content="/img/poster.png">
<meta name="og:title" content="Docspell – Simple Document Organizer">
<meta name="og:site_name" content="Upload Request - Docspell">
<meta name="og:url" content="">
<meta name="og:type" content="website">
<meta name="og:description" content="Simple Document Organizer">
<meta name="twitter:title" content="Docspell">
<meta name="twitter:image" content="/img/poster.png">
<meta name="twitter:description" content="Simple Document Organizer">
<meta name="twitter:card" content="summary_large_image">

<link rel="shortcut icon" href="/favicon-mc.ico" type="image/x-icon">
<link rel="icon" href="/favicon-mc.ico" type="image/x-icon">

        <title>Upload Request – Docspell Documentation</title>
        <link rel="stylesheet" href="/styles.css">
    </head>
    <body>
        <section class="hero is-info is-small">
            <div class="hero-head">
                <nav class="navbar">
    <div class="navbar-brand">
        <a class="navbar-item" href="/">
            <span class="icon">
                <img src="/icons/logo-only-36.svg">
            </span>
            <span>
                Docspell
            </span>
        </a>
    </div>
    <div class="navbar-start">
        <a target="_blank"
           href="https://github.com/eikek/docspell"
           class="navbar-item">
            <span class="icon">
                <img src="/icons/github-40.svg">
            </span>
            <span>
                Github
            </span>
        </a>
    </div>
</nav>

            </div>
            <div class="hero-body">
                <div class="columns is-vcentered">
                    <div class="column is-8">
                        <h1 class="title">
                            Upload Request
                        </h1>
                        <h2 class="subtitle">
                            Docspell Documentation
                        </h2>
                    </div>
                    <div class="column">
                        <id id="search"></id>
                    </div>
                </div>
            </div>
        </section>
        <nav class="breadcrumb has-succeeds-separator" aria-label="breadcrumbs"
             style="position:sticky; top: 0; z-index:10;">
            <ul>
                
                
                <li>
                    <a href="https:&#x2F;&#x2F;docspell.org&#x2F;"></a>
                </li>
                
                
                <li>
                    <a href="https:&#x2F;&#x2F;docspell.org&#x2F;docs&#x2F;">Overview</a>
                </li>
                
                
                <li>
                    <a href="https:&#x2F;&#x2F;docspell.org&#x2F;docs&#x2F;api&#x2F;">Api</a>
                </li>
                
                <li>
                    <a href="https:&#x2F;&#x2F;docspell.org&#x2F;docs&#x2F;api&#x2F;upload&#x2F;">Upload Request</a>
                </li>
            </ul>
        </nav>

        <section class="section pt-2">
            <div class="columns is-desktop">
                <div class="column is-3">
                    <div class="menu"
                         style="position:sticky; top:2rem; z-index:10;">
                        <ul class="menu-list">
                            
                            

                            <p class="menu-label">
                                Api
                            </p>
                            
                            
                            <li>
                                <a href="https://docspell.org/docs/api/intro/"
                                   >
                                    Api Introduction
                                </a>
                                
                            </li>
                            
                            
                            <li>
                                <a href="https://docspell.org/docs/api/upload/"
                                   class="is-active">
                                    Upload Request
                                </a>
                                
                                <ul class="menu-list">
                                    
                                    <li>
                                        <a href="https:&#x2F;&#x2F;docspell.org&#x2F;docs&#x2F;api&#x2F;upload&#x2F;#metadata">
                                            Metadata
                                        </a>
                                        <ul>
                                            
                                        </ul>
                                    </li>
                                    
                                    <li>
                                        <a href="https:&#x2F;&#x2F;docspell.org&#x2F;docs&#x2F;api&#x2F;upload&#x2F;#endpoints">
                                            Endpoints
                                        </a>
                                        <ul>
                                            
                                            <li>
                                                <a href="https:&#x2F;&#x2F;docspell.org&#x2F;docs&#x2F;api&#x2F;upload&#x2F;#authenticated-user">
                                                    Authenticated User
                                                </a>
                                            </li>
                                            
                                            <li>
                                                <a href="https:&#x2F;&#x2F;docspell.org&#x2F;docs&#x2F;api&#x2F;upload&#x2F;#url-protected">
                                                    URL protected
                                                </a>
                                            </li>
                                            
                                            <li>
                                                <a href="https:&#x2F;&#x2F;docspell.org&#x2F;docs&#x2F;api&#x2F;upload&#x2F;#integration-endpoint">
                                                    Integration Endpoint
                                                </a>
                                            </li>
                                            
                                        </ul>
                                    </li>
                                    
                                </ul>
                                
                            </li>
                            
                        </ul>
                    </div>
                </div>

                <div class="column is-9">
                    <div class="container">
                        <div class="content doc">
                            <p>Uploads of files to docspell are always processed the same way, no
matter if coming from a source, the integration endpoint or from the
webapp.</p>
<p>The request must be a http <code>multipart/form-data</code> request, with two
possible fields:</p>
<ul>
<li>meta</li>
<li>file</li>
</ul>
<p>The <code>file</code> field can appear multiple times and is required at least
once. It is the part containing the file to upload.</p>
<p>The <code>meta</code> part is optional and can define additional meta data, that
docspell applies to items created from the given files. It allows to
transfer structured information together with the unstructured binary
files.</p>
<p>This kind of request is very common and most programming languages
have support for this.</p>
<p>For example, here is a curl command uploading two files with meta
data. Since <code>multiple</code> is <code>false</code>, both files are added to one item:</p>
<pre data-lang="bash" style="background-color:#282828;color:#fdf4c1aa;" class="language-bash "><code class="language-bash" data-lang="bash"><span style="color:#fdf4c1;">curl -XPOST -F meta=</span><span style="color:#b8bb26;">&#39;{&quot;multiple&quot;:false, &quot;direction&quot;: &quot;outgoing&quot;, &quot;tags&quot;: {&quot;items&quot;:[&quot;Order&quot;]}}&#39; </span><span style="color:#fdf4c1;">\
</span><span style="color:#fdf4c1;">            -F file=@letter-en.pdf \
</span><span style="color:#fdf4c1;">            -F file=@letter-de.pdf \
</span><span style="color:#fdf4c1;">            http://192.168.1.95:7880/api/v1/open/upload/item/3H7hvJcDJuk-NrAW4zxsdfj-K6TMPyb6BGP-xKptVxUdqWa
</span></code></pre>
<h1 id="metadata">Metadata<a class="zola-anchor" href="#metadata" aria-label="Anchor link for: metadata">🔗</a></h1>
<p>Each upload request can specify a set of metadata that should be
applied to the item(s) that are created from this upload. This is
specified via a JSON structure in a part with name <code>meta</code>:</p>
<pre data-lang="elm" style="background-color:#282828;color:#fdf4c1aa;" class="language-elm "><code class="language-elm" data-lang="elm"><span style="color:#fabd2f;">{</span><span> multiple</span><span style="color:#fe8019;">: </span><span style="color:#fdf4c1;">Bool
</span><span style="color:#fabd2f;">,</span><span> direction</span><span style="color:#fe8019;">: </span><span style="color:#fdf4c1;">Maybe String
</span><span style="color:#fabd2f;">,</span><span> folder</span><span style="color:#fe8019;">: </span><span style="color:#fdf4c1;">Maybe String
</span><span style="color:#fabd2f;">,</span><span> skipDuplicates</span><span style="color:#fe8019;">: </span><span style="color:#fdf4c1;">Maybe Bool
</span><span style="color:#fabd2f;">,</span><span> tags</span><span style="color:#fe8019;">: </span><span style="color:#fdf4c1;">Maybe StringList
</span><span style="color:#fabd2f;">,</span><span> fileFilter</span><span style="color:#fe8019;">: </span><span style="color:#fdf4c1;">Maybe String
</span><span style="color:#fabd2f;">,</span><span> language</span><span style="color:#fe8019;">: </span><span style="color:#fdf4c1;">Maybe String
</span><span style="color:#fabd2f;">,</span><span> attachmentsOnly</span><span style="color:#fe8019;">: </span><span style="color:#fdf4c1;">Maybe Bool
</span><span style="color:#fabd2f;">}
</span></code></pre>
<ul>
<li>
<p>The <code>multiple</code> property is by default <code>true</code>. It means that each
file in the upload request corresponds to a single item. An upload
with 5 files will result in 5 items created. If it is <code>false</code>, then
docspell will create just one item, that will then contain all
files.</p>
</li>
<li>
<p>Furthermore, the direction of the document (one of <code>incoming</code> or
<code>outgoing</code>) can be given. It is optional, it can be left out or
<code>null</code>.</p>
</li>
<li>
<p>A <code>folder</code> id can be specified. Each item created by this request
will be placed into this folder. Errors are logged (for example, the
folder may have been deleted before the task is executed) and the
item is then not put into any folder.</p>
</li>
<li>
<p>The <code>skipDuplicates</code> is optional and set to <code>false</code> if not
specified. It configures the processing task. If set to <code>true</code>, the
processing task will skip all input files that are already present
in docspell.</p>
</li>
<li>
<p>The <code>tags</code> field can be used to provide tags that should be applied
automatically. The <code>StringList</code> is a json object containing one
field <code>items</code> that is a list of strings:</p>
<pre data-lang="elm" style="background-color:#282828;color:#fdf4c1aa;" class="language-elm "><code class="language-elm" data-lang="elm"><span style="color:#fabd2f;">{</span><span> items</span><span style="color:#fe8019;">: </span><span style="color:#fa5c4b;">(</span><span style="color:#fdf4c1;">List String</span><span style="color:#fa5c4b;">)
</span><span style="color:#fabd2f;">}
</span></code></pre>
<p>Tags can be defined using their ids or names.</p>
</li>
<li>
<p>Then a <code>fileFilter</code> field can be used to filter files from uploaded
archives. Say you upload a zip file and want only to include certain
files, you could give a file filter like <code>*.pdf</code> to only select pdf
files or <code>*.html|*.pdf</code> for selecting html and pdf files. This only
applies to archive files, like zip or e-mails (where this is applied
to the attachments).</p>
</li>
<li>
<p>The <code>language</code> is used for processing the document(s) contained in
the request. If not specified the collective's default language is
used.</p>
</li>
<li>
<p>The <code>attachmentsOnly</code> property only applies to e-mail files (usually
<code>*.eml</code>). If this is <code>true</code>, then the e-mail body is discarded and
only the attachments are imported. An e-mail without any attachments
is therefore skipped.</p>
</li>
</ul>
<h1 id="endpoints">Endpoints<a class="zola-anchor" href="#endpoints" aria-label="Anchor link for: endpoints">🔗</a></h1>
<p>Docspell needs to know the collective that owns the files. There are
the following ways for this.</p>
<h2 id="authenticated-user">Authenticated User<a class="zola-anchor" href="#authenticated-user" aria-label="Anchor link for: authenticated-user">🔗</a></h2>
<pre style="background-color:#282828;color:#fdf4c1aa;"><code><span>/api/v1/sec/upload/item
</span></code></pre>
<p>This endpoint exists for authenticated users. That is, you must
provide a valid cookie or <code>X-Docspell-Auth</code> header with the request.
You can obtain this from the <code>login</code> endpoint.</p>
<h2 id="url-protected">URL protected<a class="zola-anchor" href="#url-protected" aria-label="Anchor link for: url-protected">🔗</a></h2>
<pre style="background-color:#282828;color:#fdf4c1aa;"><code><span>/api/v1/open/upload/item/5JE…-…-…-…oHri
</span></code></pre>
<p>A more flexible way for uploading files is to create a
<a href="https://docspell.org/docs/webapp/uploading/#anonymous-upload">“Source”</a> that creates a
“hard-to-guess” url. A source can be created in the webapp (via http
calls) and associates a random id to a collective. This id is then
used in the url and docspell can use it to associate the collective
when uploading.</p>
<p>When defining sources, you can also add metadata to it. These will be
used as a fallback when inspecting the requests meta data part. Each
metadata not defined in the request will be filled with the one from
the corresponding source. Tags are applied from both inputs.</p>
<h2 id="integration-endpoint">Integration Endpoint<a class="zola-anchor" href="#integration-endpoint" aria-label="Anchor link for: integration-endpoint">🔗</a></h2>
<p>Another option for uploading files is the special <em>integration
endpoint</em>. This endpoint allows an admin to upload files to any
collective, that is known by name.</p>
<pre style="background-color:#282828;color:#fdf4c1aa;"><code><span>/api/v1/open/integration/item/[collective-name]
</span></code></pre>
<p>The endpoint is behind <code>/api/v1/open</code>, so this route is not protected
by an authentication token (see <a href="https://docspell.org/docs/api/">REST Api</a> for
more information). However, it can be protected via settings in the
configuration file. The idea is that this endpoint is controlled by an
administrator and not the user of the application. The admin can
enable this endpoint and choose between some methods to protect it.
Then the administrator can upload files to any collective. This might
be useful to connect other trusted applications to docspell (that run
on the same host or network).</p>
<p>The endpoint is disabled by default, an admin must change the
<code>docspell.server.integration-endpoint.enabled</code> flag to <code>true</code> in the
<a href="https://docspell.org/docs/configure/#rest-server">configuration file</a>.</p>
<p>If queried by a <code>GET</code> request, it returns whether it is enabled and
the collective exists.</p>
<p>It is also possible to check for existing files using their sha256
checksum with:</p>
<pre style="background-color:#282828;color:#fdf4c1aa;"><code><span>/api/v1/open/integration/checkfile/[collective-name]/[sha256-checksum]
</span></code></pre>
<p>See the <a href="https://docspell.org/docs/tools/smtpgateway/">SMTP gateway</a> or the <a href="https://docspell.org/docs/tools/cli/#docker">dsc
watch/upload</a> command for example can use
this endpoint.</p>

                        </div>
                    </div>
                </div>
            </div>
        </section>

        <footer class="footer">
    <div class="container">
        <div class="content has-text-centered">
            <span>
                Docspell 0.31.0
            </span>
            <span class="ml-1 mr-1">•</span>
            <a href="https://spdx.org/licenses/AGPL-3.0-or-later.html" target="_blank">AGPLv3+</a>
            <span class="ml-1 mr-1">•</span>
            <a href="https://github.com/eikek/docspell" target="_blank">
                Source Code
            </a>
            <span class="ml-1 mr-1">•</span>
            <span>
                Chat on <a href="https://gitter.im/eikek/docspell">Gitter</a>/<a href="https://app.element.io/#/room/#eikek_docspell:gitter.im">Matrix</a>
            </span>
        </div>
    </div>
    
</footer>

        <script type="text/javascript" src="https://docspell.org/elasticlunr.min.js"></script>
<script type="text/javascript" src="https://docspell.org/search_index.en.js"></script>
<script type="text/javascript" src="https://docspell.org/js/searchhelper.js"></script>
<script type="text/javascript" src="https://docspell.org/js/bundle.js"></script>

        <script>
 var initSearch = function() {
     var elmSearch = Elm.Search.init({
         node: document.getElementById("search"),
         flags: {}
     });
     initElmSearch(elmSearch);
 }
 if (document.readyState === "complete" ||
     (document.readyState !== "loading" && !document.documentElement.doScroll)
 ) {
     initSearch();
 } else {
     document.addEventListener("DOMContentLoaded", initSearch);
 }
</script>

        <!-- Fathom - simple website analytics - https://github.com/usefathom/fathom -->
<script>
 (function(f, a, t, h, o, m){
     a[h]=a[h]||function(){
         (a[h].q=a[h].q||[]).push(arguments)
     };
     o=f.createElement('script'),
     m=f.getElementsByTagName('script')[0];
     o.async=1; o.src=t; o.id='fathom-script';
     m.parentNode.insertBefore(o,m)
 })(document, window, '//webstats.daheim.site/tracker.js', 'fathom');
 fathom('set', 'siteId', 'OGJDF');
 fathom('trackPageview');
</script>
<!-- / Fathom -->

    </body>
</html>
